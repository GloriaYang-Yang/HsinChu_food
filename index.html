<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åƒé£¯çš‡å¸å¤§ - é›²ç«¯åŒæ­¥ç‰ˆ</title>
    <style>
        /* å»¶ç”¨ä¹‹å‰çš„æ¨£å¼ï¼Œåƒ…å¢åŠ è®€å–å‹•ç•« */
        /* æŠŠé€™æ®µåŠ åœ¨ <style> æ¨™ç±¤å…§ */
        h1::before {
            content: "ğŸ³ "; /* åœ¨æ¨™é¡Œå‰é¢åŠ å€‹å¯æ„›çš„è·åŒ…è›‹ */
        }

        .container {
            border-top: 10px solid #ffbe0b; /* æ›ä¸€å€‹æš–æ´‹æ´‹çš„æ—©é¤é»ƒé¡è‰² */
        }
        :root { --main-color: #e67e22; --bg-color: #fff9f2; }
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: var(--bg-color); text-align: center; padding: 20px; }
        .container { max-width: 450px; margin: auto; background: white; padding: 25px; border-radius: 25px; box-shadow: 0 15px 35px rgba(0,0,0,0.1); }
        select, button { width: 100%; padding: 15px; margin: 10px 0; border-radius: 12px; font-size: 16px; border: 1px solid #ddd; }
        button { background: var(--main-color); color: white; border: none; font-weight: bold; cursor: pointer; }
        #result { margin-top: 25px; display: none; padding: 20px; background: #fffcf0; border-radius: 15px; border: 1px solid #ffeaa7; }
        .loading { color: #999; font-style: italic; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ¤´ åƒé£¯çš‡å¸å¤§ (é›²ç«¯ç‰ˆ)</h1>
    <div id="status" class="loading">æ­£åœ¨å‘å¾¡è†³æˆ¿èª¿é–±æ¸…å–®...</div>
    
    <div id="main-ui" style="display:none;">
        <select id="mood">
            <option value="breakfast">â˜• æ—©å®‰æ™¨ä¹‹ç¾ (æ—©é¤/æ—©åˆé¤)</option>
            <option value="korean">ğŸŒ¶ï¸ éŸ“å¼æ–™ç†</option>
            <option value="light">ğŸ¥— è¼•é£Ÿéºµé£Ÿ</option>
            <option value="heavy">ğŸ¥© é£½è¶³å¤§é¤</option>
            <option value="fancy">ğŸ· è³ªæ„Ÿæ°£æ°›</option>
        </select>
        <button onclick="pickFood()">ç¿»ç‰Œå­</button>
        <div id="result">
            <div id="foodName" le="font-size: 22px; font-weight: bold;"></div>
            <p id="foodReason" style="color: #636e72;"></p>
            <a id="mapBtn" target="_blank" style="color: #0984e3; font-weight: bold; text-decoration: none;">ğŸ“ åœ°åœ–é–‹å•Ÿ</a>
        </div>
    </div>
</div>

<script>
    // âš ï¸ é€™è£¡è²¼ä¸Šä½ å¾ Google è©¦ç®—è¡¨ç™¼å¸ƒçš„ CSV ç¶²å€
    const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ1a-YS-sVsEOoP-K5efI4VzueDPRLXNhe4Xl_Lrg1asd2ovmTF--E1oiJYiWQOkeChrpkWQuMQ4v_r/pub?output=csv'; 
    let cloudDatabase = [];

    // åˆå§‹åŒ–è®€å–è³‡æ–™
    async function init() {
        try {
            const response = await fetch(csvUrl);
            const data = await response.text();
            const rows = data.split('\n').slice(1); // è·³éæ¨™é¡Œåˆ—
            
            cloudDatabase = rows.map(row => {
                const [category, name, reason] = row.split(',');
                return { category: category.trim(), name: name.trim(), reason: reason.trim() };
            });

            document.getElementById('status').style.display = 'none';
            document.getElementById('main-ui').style.display = 'block';
        } catch (e) {
            document.getElementById('status').innerText = 'å¾¡è†³æˆ¿é€£ç·šå¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²å€ã€‚';
        }
    }

    function pickFood() {
        const mood = document.getElementById('mood').value;
        const choices = cloudDatabase.filter(item => item.category === mood);
        
        if (choices.length === 0) {
            alert('é€™é¡åˆ¥ç›®å‰æ²’æ”¶éŒ„å–”ï¼å¿«å»è©¦ç®—è¡¨åŠ ä¸€ä¸‹ã€‚');
            return;
        }

        const res = choices[Math.floor(Math.random() * choices.length)];
        document.getElementById('foodName').innerText = res.name;
        document.getElementById('foodReason').innerText = res.reason;
        document.getElementById('mapBtn').href = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(res.name)}`;
        document.getElementById('result').style.display = 'block';
    }

    init();
</script>
</body>
</html>

